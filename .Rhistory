risk=="1"~"Average_risk",
TRUE ~ "High_risk")) %>%
mutate(risk=factor(risk,levels = c("Low_risk","Average_risk","High_risk"))) %>%
mutate(risk_category=str_c(risk,sex,sep="_"))
jk %>% ungroup() %>% # necessary because otherwise grouping vriable cant modify
mutate(risk=case_when(risk=="0.5"~"Low_risk",
risk=="1"~"Average_risk",
TRUE ~ "High_risk")) %>%
mutate(risk=factor(risk,levels = c("Low_risk","Average_risk","High_risk"))) %>%
mutate(risk_category=str_c(risk,sex,sep="_")) %>%
ggplot(aes(x=age,y=percentage_benefit,group=sex,color=sex))+
geom_line()   +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_wrap(~risk_category,ncol=1)
jk = jk %>% ungroup() %>% # necessary because otherwise grouping vriable cant modify
mutate(risk=case_when(risk=="0.5"~"Low_risk",
risk=="1"~"Average_risk",
TRUE ~ "High_risk")) %>%
mutate(risk=factor(risk,levels = c("Low_risk","Average_risk","High_risk"))) %>%
mutate(risk_category=str_c(risk,sex,sep="_"))
levels(jk$risk_category)
levels(as.factor(jk$risk_category))
fct_inorder(jk$risk_category)
jk %>% ungroup() %>% # necessary because otherwise grouping vriable cant modify
mutate(risk=case_when(risk=="0.5"~"Low_risk",
risk=="1"~"Average_risk",
TRUE ~ "High_risk")) %>%
mutate(risk=factor(risk,levels = c("Low_risk","Average_risk","High_risk"))) %>%
mutate(risk_category=str_c(risk,sex,sep="_")) %>%
mutate(risk_category=fct_inorder(risk_category))
jk %>% mutate(risk_category=fct_inorder(risk_category)) %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,group=risk_category,color=risk_category))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
jk %>% mutate(risk_category=fct_inorder(risk_category)) %>%
ggplot(aes(x=age,y=lifespangain,group=risk_category,color=risk_category))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
jk %>% mutate(risk_category=fct_inorder(risk_category)) %>%
ggplot(aes(x=age,y=percentage_benefit,group=risk_category,color=risk_category))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
jk %>% mutate(risk_category=fct_inorder(risk_category)) %>%
ggplot(aes(x=risk_category,y=lifespan_gain_in_beneficiary_yrs,fill=risk_category))+
geom_boxplot()
library(ggridges)
jk %>% mutate(risk_category=fct_inorder(risk_category)) %>%
ggplot(aes(x=risk_category,y=lifespan_gain_in_beneficiary_yrs,fill=risk_category))+
geom_joy()
library(ggjoy)
jk %>% mutate(risk_category=fct_inorder(risk_category)) %>%
ggplot(aes(x=risk_category,y=lifespan_gain_in_beneficiary_yrs,fill=risk_category))+
geom_joy()
jk %>% mutate(risk_category=fct_inorder(risk_category)) %>%
ggplot(aes(y=risk_category,x=lifespan_gain_in_beneficiary_yrs,fill=risk_category))+
geom_joy()
jk %>% mutate(decade=cut_width(age,10))
jk %>% mutate(decade=cut_interval(age,10))
jk %>% mutate(decade=cut_interval(x=age,10))
cut_number(jk$age,10)
str(jk$age)
jk$age=as.numeric(jk$age)
jk %>% mutate(risk_category=fct_inorder(risk_category)) %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,group=risk_category,color=risk_category))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
jk %>% mutate(risk_category=fct_inorder(risk_category)) %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,group=risk_category,color=risk_category))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
# Risk category_lifespan_boxplot
jk %>% mutate(risk_category=fct_inorder(risk_category)) %>%
ggplot(aes(x=risk_category,y=lifespan_gain_in_beneficiary_yrs,fill=risk_category))+
geom_boxplot
# Risk category_lifespan_boxplot
jk %>% mutate(risk_category=fct_inorder(risk_category)) %>%
ggplot(aes(x=risk_category,y=lifespan_gain_in_beneficiary_yrs,fill=risk_category))+
geom_boxplot()
# Risk category_lifespan_boxplot
jk %>% mutate(risk_category=fct_inorder(risk_category)) %>%
ggplot(aes(x=risk_category,y=lifespan_gain_in_beneficiary_yrs,fill=risk_category))+
geom_boxplot()+coord_flip()
jk %>% mutate(decade=cut_interval(age,10))
jk %>% mutate(decade=cut_interval(age,10)) %>% summary()
jk %>% mutate(decade=cut_width(age,10)) %>% summary()
jk %>% mutate(decade=cut_interval(age,10)) %>% summary()
jk %>% mutate(decade=cut(age, breaks = seq(35,85,by=10), right = TRUE))
jk=jj %>% group_by(age=as.factor(age),risk=as.factor(risk),sex=as.factor(sex)) %>%
summarise(lifespangain=mean(extra),percentage_benefit = (sum(extra>0)/1000)*100,
lifespan_gain_in_beneficiary = sum(extra)/sum(extra>0)) %>%
mutate(lifespan_gain_in_beneficiary_yrs=round(lifespan_gain_in_beneficiary/365,2)) %>%
ungroup()
summary(jk)
summary(jk$age)
str(jk$age)
jk=jj %>% group_by(age=as.factor(age),risk=as.factor(risk),sex=as.factor(sex)) %>%
summarise(lifespangain=mean(extra),percentage_benefit = (sum(extra>0)/1000)*100,
lifespan_gain_in_beneficiary = sum(extra)/sum(extra>0)) %>%
mutate(lifespan_gain_in_beneficiary_yrs=round(lifespan_gain_in_beneficiary/365,2)) %>%
ungroup() %>% # necessary because otherwise grouping vriable cant modify
mutate(age=as.numeric(as.character(age))) %>%
mutate(risk=case_when(risk=="0.5"~"Low_risk",
risk=="1"~"Average_risk",
TRUE ~ "High_risk")) %>%
mutate(risk=factor(risk,levels = c("Low_risk","Average_risk","High_risk"))) %>%
mutate(risk_category=str_c(risk,sex,sep="_")) %>%
mutate(risk_category=fct_inorder(risk_category))
summary(jk)
cut_number(jk$age,10)
cut_width(jk$age,10)
cut_interval(jk$age,10)
jk %>% mutate(risk_category=fct_inorder(risk_category)) %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,group=risk_category,color=risk_category))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
jk %>% ggplot(aes(x=age,y=percentage_benefit,group=sex,color=sex))+
geom_line()   +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_wrap(~risk,nrow=3)
jk %>% ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,group=sex,color=sex))+
geom_line()   +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_wrap(~risk,nrow=3)
jk %>% ggplot(aes(x=age,y=percentage_benefit,group=sex,color=sex))+
geom_line()   +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_wrap(~risk,ncol=1)
jk %>% ggplot(aes(x=age,y=percentage_benefit,group=sex,color=sex))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_wrap(~risk,ncol=1)
jk %>% ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,group=sex,color=sex))+
geom_line()   +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_wrap(~risk,ncol=1)
jk %>% mutate(decade=age%/%10)
jk %>% mutate(decade=fct_inorder(age%/%10))
jk %>% mutate(decade=fct_inorder(as.character(age%/%10)))
jk %>% mutate(decade=fct_inorder(as.character(age%/%10))) %>%
ggplot(aes(x=decade,y=percentage_benefit,fill=decade))+
geom_boxplot()
jk %>% mutate(decade=fct_inorder(as.character(age%/%10))) %>%
ggplot(aes(x=decade,y=lifespan_gain_in_beneficiary_yrs,fill=decade))+
geom_boxplot()
jk %>% mutate(decade=fct_inorder(as.character(age%/%10))) %>%
ggplot(aes(x=lifespan_gain_in_beneficiary_yrs,coloor=decade))+
geom_freqpoly()
k %>% mutate(decade=fct_inorder(as.character(age%/%10))) %>%
ggplot(aes(x=lifespan_gain_in_beneficiary_yrs,color=decade))+
geom_freqpoly()
jk %>% mutate(decade=fct_inorder(as.character(age%/%10))) %>%
ggplot(aes(x=lifespan_gain_in_beneficiary_yrs,color=decade))+
geom_freqpoly()
jk %>% mutate(decade=fct_inorder(as.character(age%/%10))) %>%
ggplot(aes(x=lifespan_gain_in_beneficiary_yrs,color=decade))+
geom_freqpoly(binwidth=0.5)
jk %>% mutate(decade=fct_inorder(as.character(age%/%10))) %>%
ggplot(aes(x=decade,y=percentage_benefit,fill=decade))+
geom_boxplot()
jk %>%
ggplot(aes(x=age,y=percentage_benefit,group=risk_category,color=fct_reorder2(risk_category,age,percentage_benefit)))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
jk %>% mutate(risk_category=fct_inorder(risk_category)) %>%
ggplot(aes(x=age,y=percentage_benefit,group=risk_category,color=risk_category))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
jk %>%
ggplot(aes(x=age,y=percentage_benefit,group=risk_category,color=fct_reorder2(risk_category,age,percentage_benefit)))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
jk %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,group=risk_category,color=fct_reorder2(risk_category,age,lifespan_gain_in_beneficiary_yrs)))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
jk %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,group=risk_category,color=fct_reorder2(risk_category,age,lifespan_gain_in_beneficiary_yrs)))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Risk status")
jk %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,group=risk_category,color=fct_reorder2(risk_category,age,lifespan_gain_in_beneficiary_yrs)))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Risk status")+
annotate("text",x=70,y=9,label="good")
mtcars
rownames(jk$risk_category)
best_in_class <- mpg %>%
group_by(class) %>%
filter(row_number(desc(hwy)) == 1)
View(best_in_class)
View(jk)
View(best_in_class)
jk %>% group_by(risk_category) %>%
summarise(lifespan_gain_in_beneficiary_yrs=mean(lifespan_gain_in_beneficiary_yrs))
jk %>% group_by(risk_category)
jk1=jk %>% group_by(risk_category) %>%
summarise(lifespan_gain_in_beneficiary_yrs=mean(lifespan_gain_in_beneficiary_yrs))
View(jk1)
jk %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,group=risk_category,color=fct_reorder2(risk_category,age,lifespan_gain_in_beneficiary_yrs)))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Risk status")+
geom_label(aes(label = risk_category), data = jk1, nudge_y = 2, alpha = 0.5)
jk %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,color=decade))+
geom_pont()   +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Decade")
jk %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,color=decade))+
geom_point()   +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Decade")
jk %>% mutate(decade=fct_inorder(as.character(age%/%10))) %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,color=decade))+
geom_point()
jk %>% mutate(decade=fct_inorder(as.character(age%/%10))) %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,color=decade))+
geom_point()   +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Decade")+
geom_label(aes(label = risk_category), data = jk1, nudge_y = 2, alpha = 0.5)
jk %>% mutate(decade=fct_inorder(as.character(age%/%10))) %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,color=decade))+
geom_point()   +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
jk %>% mutate(decade=fct_inorder(as.character(age%/%10))) %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,color=decade))+
geom_point()   +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Decade")
jk %>% group_by(decade) %>%
summarise(lifespan_gain_in_beneficiary_yrs=mean(lifespan_gain_in_beneficiary_yrs))
jk=jj %>% group_by(age=as.factor(age),risk=as.factor(risk),sex=as.factor(sex)) %>%
summarise(lifespangain=mean(extra),percentage_benefit = (sum(extra>0)/1000)*100,
lifespan_gain_in_beneficiary = sum(extra)/sum(extra>0)) %>%
mutate(lifespan_gain_in_beneficiary_yrs=round(lifespan_gain_in_beneficiary/365,2)) %>%
ungroup() %>% # necessary because otherwise grouping vriable cant modify
mutate(age=as.numeric(as.character(age))) %>%
mutate(risk=case_when(risk=="0.5"~"Low_risk",
risk=="1"~"Average_risk",
TRUE ~ "High_risk")) %>%
mutate(risk=factor(risk,levels = c("Low_risk","Average_risk","High_risk"))) %>%
mutate(risk_category=str_c(risk,sex,sep="_")) %>%
mutate(risk_category=fct_inorder(risk_category)) %>%
mutate(decade=fct_inorder(as.character(age%/%10)))
jk %>% mutate(decade=fct_inorder(as.character(age%/%10))) %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,color=decade))+
geom_point()   +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Decade")+
geom_label(aes(label = risk_category), data = jk1, nudge_y = 2, alpha = 0.5)
k1=jk %>% group_by(decade) %>%
summarise(lifespan_gain_in_beneficiary_yrs=mean(lifespan_gain_in_beneficiary_yrs))
View(jk1)
jk %>% mutate(decade=fct_inorder(as.character(age%/%10))) %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,color=decade))+
geom_point()   +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Decade")+
geom_label(aes(label = risk_category), data = jk1, nudge_y = 2, alpha = 0.5)
jk %>% group_by(decade) %>%
summarise(lifespan_gain_in_beneficiary_yrs=mean(lifespan_gain_in_beneficiary_yrs))
jk1=jk %>% group_by(decade) %>%
summarise(lifespan_gain_in_beneficiary_yrs=mean(lifespan_gain_in_beneficiary_yrs))
View(jk1)
k %>% mutate(decade=fct_inorder(as.character(age%/%10))) %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,color=decade))+
geom_point()   +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Decade")+
geom_label(aes(label = decade), data = jk1, nudge_y = 2, alpha = 0.5)
jk %>% mutate(decade=fct_inorder(as.character(age%/%10))) %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,color=decade))+
geom_point()   +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Decade")+
geom_label(aes(label = decade), data = jk1, nudge_y = 2, alpha = 0.5)
View(best_in_class)
ggplot(mpg, aes(displ, hwy)) +
geom_point(aes(colour = class))
jk  %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs))+
geom_point(color=decade)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Decade")
View(jk)
View(jk)
jk  %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs))+
geom_point(aes(color=decade))  +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Decade")
library(ggrepel)
View(jk)
jk  %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs))+
geom_point(aes(color=decade))  +
geom_label_repel(aes(label = risk_category))
jk  %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs))+
geom_point(aes(color=decade))  +
geom_label_repel(aes(label = decade))
jk  %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs))+
geom_label_repel(aes(label = decade))+
geom_point()
class_avg <- jk %>%
group_by(risk_category) %>%
summarise(
age = median(age),
lifespan_gain_in_beneficiary_yrs = median(lifespan_gain_in_beneficiary_yrs)
)
jk  %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs))+
geom_point(aes(color=decade))  +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Decade")+
jk  %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs))+
geom_point(aes(color=decade))
View(class_avg)
jk  %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs))+
geom_point(aes(color=decade))  +
geom_label_repel(aes(label=risk_category),data=class_avg)
jk  %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs))+
geom_point()+
geom_label_repel(aes(label=risk_category),data=class_avg)
jk  %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs))+
geom_point(aes(color=risk_category))+
geom_label_repel(aes(label=risk_category),data=class_avg)
data2 <- structure(list(type = structure(c(5L, 1L, 2L, 4L, 3L, 5L, 1L,
2L, 4L, 3L, 5L, 1L, 2L, 4L, 3L, 5L, 1L, 2L, 4L, 3L), .Label = c("EDS",
"KIU", "LAK", "MVH", "NA*"), class = "factor"), value = c(0.9,
0.01, 0.01, 0.09, 0, 0.8, 0.05, 0, 0.15, 0, 0.41, 0.04, 0.03,
0.52, 0, 0.23, 0.11, 0.02, 0.64, 0.01), time = c(3L, 3L, 3L,
3L, 3L, 6L, 6L, 6L, 6L, 6L, 15L, 15L, 15L, 15L, 15L, 27L, 27L,
27L, 27L, 27L), year = c(2008L, 2008L, 2008L, 2008L, 2008L, 2007L,
2007L, 2007L, 2007L, 2007L, 2007L, 2007L, 2007L, 2007L, 2007L,
2006L, 2006L, 2006L, 2006L, 2006L)), .Names = c("type", "value",
"time", "year"), row.names = c(1L, 3L, 4L, 5L, 6L, 7L, 9L, 10L,
data2 <- structure(list(type = structure(c(5L, 1L, 2L, 4L, 3L, 5L, 1L,
2L, 4L, 3L, 5L, 1L, 2L, 4L, 3L, 5L, 1L, 2L, 4L, 3L), .Label = c("EDS",
"KIU", "LAK", "MVH", "NA*"), class = "factor"), value = c(0.9,
0.01, 0.01, 0.09, 0, 0.8, 0.05, 0, 0.15, 0, 0.41, 0.04, 0.03,
data2 <- structure(list(type = structure(c(5L, 1L, 2L, 4L, 3L, 5L, 1L,
2L, 4L, 3L, 5L, 1L, 2L, 4L, 3L, 5L, 1L, 2L, 4L, 3L), .Label = c("EDS",
"KIU", "LAK", "MVH", "NA*"), class = "factor"), value = c(0.9,
0.01, 0.01, 0.09, 0, 0.8, 0.05, 0, 0.15, 0, 0.41, 0.04, 0.03,
0.52, 0, 0.23, 0.11, 0.02, 0.64, 0.01), time = c(3L, 3L, 3L,
3L, 3L, 6L, 6L, 6L, 6L, 6L, 15L, 15L, 15L, 15L, 15L, 27L, 27L,
27L, 27L, 27L), year = c(2008L, 2008L, 2008L, 2008L, 2008L, 2007L,
2007L, 2007L, 2007L, 2007L, 2007L, 2007L, 2007L, 2007L, 2007L,
2006L, 2006L, 2006L, 2006L, 2006L)), .Names = c("type", "value",
"time", "year"), row.names = c(1L, 3L, 4L, 5L, 6L, 7L, 9L, 10L,
11L, 12L, 13L, 15L, 16L, 17L, 18L, 19L, 21L, 22L, 23L, 24L), class = "data.frame")
ggplot(data2, aes(x=time, y=value, group=type, col=type))+
geom_line()+
geom_point()+
theme_bw()
View(data2)
ggplot(data2, aes(x=time, y=value, group=type, col=type))+
geom_line()+
geom_point()+
theme_bw()+
annotate("text", x=6, y=0.9, label="this is a wrong color")+
annotate("text", x=15, y=0.6, label="this is a second annotation with a wrong color")
ggplot(data2, aes(x=time, y=value, group=type, col=type))+
geom_line()+
geom_point()+
theme_bw()
ggplot(data2, aes(x=time, y=value, group=type, col=type))+
geom_line()+
geom_point()+
theme_bw()+
annotate("text", x=6, y=0.9, label="this is a wrong color")+
annotate("text", x=15, y=0.6, label="this is a second annotation with a wrong color")
data2.labels <- data.frame(
time = c(7, 15),
value = c(.9, .6),
label = c("correct color", "another correct color!"),
type = c("NA*", "MVH")
)
ggplot(data2, aes(x=time, y=value, group=type, col=type))+
geom_line()+
geom_point()+
theme_bw() +
geom_text(data = data2.labels, aes(x = time, y = value, label = label))
jk %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,group=risk_category,color=fct_reorder2(risk_category,age,lifespan_gain_in_beneficiary_yrs)))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Risk status")+
annotate("text",x=70,y=9,label="good")
jk.labels <- data.frame(
x = c(40, 60),
y = c(10, 10),
label = c("correct color", "another correct color!"),
type = c("Average_risk_male", "high_risk_male")
)
jk.labels <- data.frame(
x = c(40, 60),
y = c(10, 10),
label = c("correct color", "another correct color!"),
risk_category= c("Average_risk_male", "high_risk_male")
)
jk %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,group=risk_category,color=fct_reorder2(risk_category,age,lifespan_gain_in_beneficiary_yrs)))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Risk status")+
geom_text(data=jk.labels,aes(x=x,y=y,label=label))
jk.labels <- data.frame(
age = c(40, 60),
lifespan_gain_in_benficiary_yrs= c(10, 10),
label = c("correct color", "another correct color!"),
risk_category= c("Average_risk_male", "high_risk_male")
)
View(jk.labels)
jk %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,group=risk_category,color=fct_reorder2(risk_category,age,lifespan_gain_in_beneficiary_yrs)))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Risk status")+
geom_text(data=jk.labels,aes(x=age,y=lifespan_gain_in_beneficiary_yrs,label=label))
View(jk)
jk %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,group=risk_category,color=fct_reorder2(risk_category,age,lifespan_gain_in_beneficiary_yrs)))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Risk status")+
geom_text(data=jk.labels,aes(x=age,y=lifespan_gain_in_benficiary_yrs,label=label))
jk %>%
ggplot(aes(x=age,y=lifespan_gain_in_beneficiary_yrs,group=risk_category,color=fct_reorder2(risk_category,age,lifespan_gain_in_beneficiary_yrs)))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Risk status")
jk %>%
ggplot(aes(x=age,y=lifespangain,group=risk_category,color=fct_reorder2(risk_category,age,lifespan_gain_in_beneficiary_yrs)))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Risk status")
jk.labels <- data.frame(
age =c(40, 60),
lifespangain=c(300, 390),
label = c("correct color", "another correct color!"),
risk_category= c("Average_risk_male", "High_risk_male")
)
k.labels <- data.frame(
age =c(40, 60),
lifespangain=c(300, 390),
label = c("correct color", "another correct color!"),
risk_category= c("Average_risk_male", "High_risk_male")
)
jk %>%
ggplot(aes(x=age,y=lifespangain,group=risk_category,color=fct_reorder2(risk_category,age,lifespan_gain_in_beneficiary_yrs)))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Risk status")+
geom_text(data=jk.labels,aes(x=age,y=lifespangain,label=label))
jk.labels <- data.frame(
age =c(40, 60),
lifespangain=c(300, 390),
label = c("correct color", "another correct color!"),
risk_category= c("Average_risk_male", "High_risk_male")
)
jk %>%
ggplot(aes(x=age,y=lifespangain,group=risk_category,color=fct_reorder2(risk_category,age,lifespan_gain_in_beneficiary_yrs)))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Risk status")+
geom_text(data=jk.labels,aes(x=age,y=lifespangain,label=label))
jk.labels <- data.frame(
age =c(40, 60),
lifespangain=c(300, 390),
label = c("correct color", "another correct color!"),
risk_category= c("Average_risk_male", "High_risk_male")
)
jk %>%
ggplot(aes(x=age,y=lifespangain,group=risk_category,color=fct_reorder2(risk_category,age,lifespangain)))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Risk status")+
geom_text(data=jk.labels,aes(x=age,y=lifespangain,label=label))
jk.labels <- data.frame(
age =c(40, 60),
lifespangain=c(300, 390),
label = c("Average risk male", "High risk male"),
risk_category= c("Average_risk_male", "High_risk_male")
)
jk %>%
ggplot(aes(x=age,y=lifespangain,group=risk_category,color=fct_reorder2(risk_category,age,lifespangain)))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Risk status")+
geom_text(data=jk.labels,aes(x=age,y=lifespangain,label=label))
jk %>%
ggplot(aes(x=age,y=lifespangain,group=risk_category,color=fct_reorder2(risk_category,age,lifespangain)))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Risk status")+
geom_label_repel(data=jk.labels,aes(x=age,y=lifespangain,label=label))
jk %>% group_by(risk_category) %>% summarise(age=max(age),lifespangain=max(lifespangain))
jk %>% group_by(risk_category) %>% summarise(age=mean(age),lifespangain=max(lifespangain))
jk.labels2=jk %>% group_by(risk_category) %>% summarise(age=mean(age),lifespangain=max(lifespangain))
jk %>%
ggplot(aes(x=age,y=lifespangain,group=risk_category,color=fct_reorder2(risk_category,age,lifespangain)))+
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)   +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(color="Risk status")+
#geom_label_repel(data=jk.labels,aes(x=age,y=lifespangain,label=label))
geom_label_repel(data=jk.labels2,aes(x=age,y=lifespangain,label=risk_category))
